{"version":"7","defaultTimeframe":{"from":"now()-2h","to":"now()"},"defaultSegments":[],"sections":[{"id":"2a480356-89cf-4bc2-962c-3aca37742c2e","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"subType":"davis-copilot","davisCopilot":{"prompt":"Show me the 100 latest error logs and group these by the log source. Sort by count.","response":{"status":"success","prompt":"Show me the 100 latest error logs and group these by the log source. Sort by count.","data":{"dql":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 100\n| summarize by:{log.source}, count = count()\n| sort count","messageToken":"2fbfc592-2207-4785-b6e6-8d9ac6bdf804","status":"SUCCESSFUL","metadata":{"notifications":[]}}},"showDqlSnippet":true,"feedbackProvided":false},"state":{"input":{"timeframe":{"from":"@d","to":"now()"},"value":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 100\n| summarize by:{log.source}, count = count()\n| sort count"},"visualizationSettings":{"autoSelectVisualization":false,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"categoricalBarChart","result":{"code":200,"value":{"records":[{"log.source":"Container Output","count":"1"},{"log.source":"Windows Application Log","count":"1"},{"log.source":"Windows System Log","count":"2"},{"log.source":"/var/log/httpd/error_log","count":"7"},{"log.source":"C:\\ProgramData\\Amazon\\SSM\\Logs\\amazon-ssm-agent.log","count":"10"},{"log.source":"C:\\ProgramData\\Amazon\\SSM\\Logs\\errors.log","count":"10"},{"log.source":"Journald","count":"22"},{"log.source":"/var/log/amazon/ssm/errors.log","count":"23"},{"log.source":"/var/log/amazon/ssm/amazon-ssm-agent.log","count":"24"}],"types":[{"indexRange":[0,8],"mappings":{"log.source":{"type":"string"},"count":{"type":"long"}}}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 100\n| summarize by:{log.source}, count = count()\n| sort count","timezone":"Asia/Calcutta","query":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 100\n| summarize by:{log.source}, count = count()\n| sort count","scannedRecords":19339,"dqlVersion":"V1_0","scannedBytes":501813,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-10-08T18:30:00.000000000Z","end":"2025-10-09T05:27:04.018000000Z"},"locale":"en-GB","executionTimeMilliseconds":27,"notifications":[],"queryId":"ab2055d5-cf34-445f-b1d6-32f8dafcb1c8","sampled":false}}},"notifications":[],"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"dateTime":"2025-10-09T05:27:04.785Z","input":{"timeframe":{"from":"@d","to":"now()"},"value":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 100\n| summarize by:{log.source}, count = count()\n| sort count"}},"state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"119e5b57-5ac7-49b6-80f3-54f6aec4b7b1","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"subType":"davis-copilot","davisCopilot":{"prompt":"Show me all hosts with CPU usage less than 60% over the last day.","response":{"status":"success","prompt":"Show me all hosts with CPU usage less than 60% over the last day.","data":{"dql":"timeseries from:now() - 24h, by:{dt.entity.host}, cpuUsage = avg(dt.host.cpu.usage)\n| fieldsAdd avgCPU = arrayAvg(cpuUsage)\n| filter avgCPU < 60","messageToken":"eb7c0f98-60aa-4e12-8c97-7584ca3f9acd","status":"SUCCESSFUL","metadata":{"notifications":[]}}},"showDqlSnippet":true,"feedbackProvided":false},"state":{"input":{"timeframe":{"from":"@d","to":"now()"},"value":""},"visualizationSettings":{"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"davisCopilot":{"prompt":"Show me all hosts with CPU usage less than 60% over the last day.","response":{"status":"idle"},"showDqlSnippet":false,"feedbackProvided":false}}},{"id":"b9b8a547-e0e5-431a-a6d4-1532b9a84c79","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"fetch logs \n| limit 10 \n| fields content, timestamp"},"visualizationSettings":{"table":{"columnTypeOverrides":[{"fields":["content"],"id":1759987915983,"value":"log-content"}],"hideColumnsForLargeResults":true},"autoSelectVisualization":true,"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","result":{"code":200,"value":{"records":[{"content":"An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tEC2AMAZ-SIE7OMF$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3E7\r\n\r\nLogon Information:\r\n\tLogon Type:\t\t5\r\n\tRestricted Admin Mode:\t-\r\n\tRemote Credential Guard:\t-\r\n\tVirtual Account:\t\tNo\r\n\tElevated Token:\t\tYes\r\n\r\nImpersonation Level:\t\tImpersonation\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3E7\r\n\tLinked Logon ID:\t\t0x0\r\n\tNetwork Account Name:\t-\r\n\tNetwork Account Domain:\t-\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x2c0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t-\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.","timestamp":"2025-10-09T10:50:39.597721000+05:30"},{"content":"An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tEC2AMAZ-SIE7OMF$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3E7\r\n\r\nLogon Information:\r\n\tLogon Type:\t\t5\r\n\tRestricted Admin Mode:\t-\r\n\tRemote Credential Guard:\t-\r\n\tVirtual Account:\t\tNo\r\n\tElevated Token:\t\tYes\r\n\r\nImpersonation Level:\t\tImpersonation\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3E7\r\n\tLinked Logon ID:\t\t0x0\r\n\tNetwork Account Name:\t-\r\n\tNetwork Account Domain:\t-\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x2c0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t-\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.","timestamp":"2025-10-09T10:50:40.390423000+05:30"},{"content":"An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tEC2AMAZ-SIE7OMF$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3E7\r\n\r\nLogon Information:\r\n\tLogon Type:\t\t5\r\n\tRestricted Admin Mode:\t-\r\n\tRemote Credential Guard:\t-\r\n\tVirtual Account:\t\tNo\r\n\tElevated Token:\t\tYes\r\n\r\nImpersonation Level:\t\tImpersonation\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3E7\r\n\tLinked Logon ID:\t\t0x0\r\n\tNetwork Account Name:\t-\r\n\tNetwork Account Domain:\t-\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x2c0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t-\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.","timestamp":"2025-10-09T10:52:35.556930000+05:30"},{"content":"Special privileges assigned to new logon.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3E7\r\n\r\nPrivileges:\t\tSeAssignPrimaryTokenPrivilege\r\n\t\t\tSeTcbPrivilege\r\n\t\t\tSeSecurityPrivilege\r\n\t\t\tSeTakeOwnershipPrivilege\r\n\t\t\tSeLoadDriverPrivilege\r\n\t\t\tSeBackupPrivilege\r\n\t\t\tSeRestorePrivilege\r\n\t\t\tSeDebugPrivilege\r\n\t\t\tSeAuditPrivilege\r\n\t\t\tSeSystemEnvironmentPrivilege\r\n\t\t\tSeImpersonatePrivilege\r\n\t\t\tSeDelegateSessionUserImpersonatePrivilege","timestamp":"2025-10-09T10:50:39.597736000+05:30"},{"content":"Special privileges assigned to new logon.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3E7\r\n\r\nPrivileges:\t\tSeAssignPrimaryTokenPrivilege\r\n\t\t\tSeTcbPrivilege\r\n\t\t\tSeSecurityPrivilege\r\n\t\t\tSeTakeOwnershipPrivilege\r\n\t\t\tSeLoadDriverPrivilege\r\n\t\t\tSeBackupPrivilege\r\n\t\t\tSeRestorePrivilege\r\n\t\t\tSeDebugPrivilege\r\n\t\t\tSeAuditPrivilege\r\n\t\t\tSeSystemEnvironmentPrivilege\r\n\t\t\tSeImpersonatePrivilege\r\n\t\t\tSeDelegateSessionUserImpersonatePrivilege","timestamp":"2025-10-09T10:50:40.390431000+05:30"},{"content":"Special privileges assigned to new logon.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3E7\r\n\r\nPrivileges:\t\tSeAssignPrimaryTokenPrivilege\r\n\t\t\tSeTcbPrivilege\r\n\t\t\tSeSecurityPrivilege\r\n\t\t\tSeTakeOwnershipPrivilege\r\n\t\t\tSeLoadDriverPrivilege\r\n\t\t\tSeBackupPrivilege\r\n\t\t\tSeRestorePrivilege\r\n\t\t\tSeDebugPrivilege\r\n\t\t\tSeAuditPrivilege\r\n\t\t\tSeSystemEnvironmentPrivilege\r\n\t\t\tSeImpersonatePrivilege\r\n\t\t\tSeDelegateSessionUserImpersonatePrivilege","timestamp":"2025-10-09T10:52:35.556983000+05:30"},{"content":"The AppX Deployment Service (AppXSVC) service entered the running state.","timestamp":"2025-10-09T10:50:39.656072000+05:30"},{"content":"The Network Setup Service service entered the running state.","timestamp":"2025-10-09T10:50:40.416599000+05:30"},{"content":"The WaaSMedicSvc service entered the running state.","timestamp":"2025-10-09T10:52:35.623938000+05:30"},{"content":"The Software Protection service entered the running state.","timestamp":"2025-10-09T10:52:35.985028000+05:30"}],"types":[{"indexRange":[0,9],"mappings":{"content":{"type":"string"},"timestamp":{"type":"timestamp"}}}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| limit 10\n| fields content, timestamp","timezone":"Asia/Calcutta","query":"fetch logs \n| limit 10 \n| fields content, timestamp","scannedRecords":427,"dqlVersion":"V1_0","scannedBytes":32196,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-10-09T03:32:24.943000000Z","end":"2025-10-09T05:32:24.943000000Z"},"locale":"en-GB","executionTimeMilliseconds":13,"notifications":[],"queryId":"ae112a42-da84-433e-aaf6-cf63ac18d399","sampled":false}}},"notifications":[],"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"dateTime":"2025-10-09T05:32:25.724Z","input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"fetch logs \n| limit 10 \n| fields content, timestamp"}},"state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}}]}